function e(e){return new Promise(function(t,r){var o=new XMLHttpRequest;if(o.open(e.method,e.url),"GET"===e.method.toUpperCase()||"DELETE"===e.method.toUpperCase())o.send(null);else if("POST"===e.method.toUpperCase()){var n=JSON.stringify(e.data);o.setRequestHeader("Content-Type","application/json"),o.send(n)}o.onreadystatechange=function(){if(4==o.readyState)if(200==o.status)try{var e="string"==typeof o.responseText?JSON.parse(o.responseText):o.responseText;t(e)}catch(e){r(e)}else r(o)}})}class t{constructor({name:e,type:t,config:r,sendApi:o,sendResource:n,sendJsError:s}){this.name=e,this.type=t,this.config=r,this.sendApi=o,this.sendJsError=s,this.sendResource=n}init(){var t,r,o;this.sendApi&&window.XMLHttpRequest&&function(){const e=window.XMLHttpRequest.prototype,t=e.send;var r=function(e){e&&e.currentTarget&&200!==e.currentTarget.status&&console.log(e.currentTarget,"apiError")};e.send=function(){if(this.addEventListener)this.addEventListener("error",r),this.addEventListener("load",r),this.addEventListener("abort",r);else{var e=this.onreadystatechange;this.onreadystatechange=function(t){4===this.readyState&&r(t),e&&e.apply(this,arguments)}}return t.apply(this,arguments)}}(),this.sendApi&&function(e){if(!window.fetch)return;let t=window.fetch;window.fetch=function(){return t.apply(this,arguments).then(e=>e).catch(e=>{throw e})}}(),this.sendJsError&&(t=this.name,r=this.type,o=this.config,window.addEventListener("error",r=>{r.target.localName||(e({method:"POST",url:"http://localhost:8081/logapi/addErrorLog",data:{title:r.error.message,type:"jsError",detail:encodeURI(r.error.stack),component:t,description:r.filename}}),console.log(r))},!0),window.addEventListener("unhandledrejection",t=>{console.log("这是Promise场景中错误",t),e({method:"POST",url:"http://localhost:8081/logapi/addErrorLog",data:{title:t,type:"jsPromiseError"}})}),"VUE"==r&&(o.errorHandler=function(r,o,n){e({method:"POST",url:"http://localhost:8081/logapi/addErrorLog",data:{title:r.message,type:"vueError",detail:encodeURI(r.stack),component:t,description:`组件${o.$vnode.tag}发生错误：${r.message}, ${n}`}}),console.log(r)})),this.sendResource&&window.addEventListener("error",e=>{e.target.localName&&console.log("这是资源错误",e)},!0)}}export{t as webMitoSdkInit};
//# sourceMappingURL=web-mito-sdk.modern.mjs.map
