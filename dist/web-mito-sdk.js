function e(e){return new Promise(function(t,n){var o=new XMLHttpRequest;if(o.open(e.method,e.url),"GET"===e.method.toUpperCase()||"DELETE"===e.method.toUpperCase())o.send(null);else if("POST"===e.method.toUpperCase()){var r=JSON.stringify(e.data);o.setRequestHeader("Content-Type","application/json"),o.send(r)}o.onreadystatechange=function(){if(4==o.readyState)if(200==o.status)try{var e="string"==typeof o.responseText?JSON.parse(o.responseText):o.responseText;t(e)}catch(e){n(e)}else n(o)}})}exports.webMitoSdkInit=/*#__PURE__*/function(){function t(e){var t=e.type,n=e.config,o=e.sendApi,r=e.sendResource,s=e.sendJsError;this.name=e.name,this.type=t,this.config=n,this.sendApi=o,this.sendJsError=s,this.sendResource=r}return t.prototype.init=function(){var t,n,o,r,s,i;this.sendApi&&window.XMLHttpRequest&&(t=window.XMLHttpRequest.prototype,n=t.send,o=function(e){e&&e.currentTarget&&200!==e.currentTarget.status&&console.log(e.currentTarget,"apiError")},t.send=function(){if(this.addEventListener)this.addEventListener("error",o),this.addEventListener("load",o),this.addEventListener("abort",o);else{var e=this.onreadystatechange;this.onreadystatechange=function(t){4===this.readyState&&o(t),e&&e.apply(this,arguments)}}return n.apply(this,arguments)}),this.sendApi&&function(e){if(window.fetch){var t=window.fetch;window.fetch=function(){return t.apply(this,arguments).then(function(e){return e}).catch(function(e){throw e})}}}(),this.sendJsError&&(r=this.name,s=this.type,i=this.config,window.addEventListener("error",function(t){t.target.localName||(e({method:"POST",url:"http://localhost:8081/logapi/addErrorLog",data:{title:t.error.message,type:"jsError",detail:encodeURI(t.error.stack),component:r,description:t.filename}}),console.log(t))},!0),window.addEventListener("unhandledrejection",function(t){console.log("这是Promise场景中错误",t),e({method:"POST",url:"http://localhost:8081/logapi/addErrorLog",data:{title:t,type:"jsPromiseError"}})}),"VUE"==s&&(i.errorHandler=function(t,n,o){e({method:"POST",url:"http://localhost:8081/logapi/addErrorLog",data:{title:t.message,type:"vueError",detail:encodeURI(t.stack),component:r,description:"组件"+n.$vnode.tag+"发生错误："+t.message+", "+o}}),console.log(t)})),this.sendResource&&window.addEventListener("error",function(e){e.target.localName&&console.log("这是资源错误",e)},!0)},t}();
//# sourceMappingURL=web-mito-sdk.js.map
