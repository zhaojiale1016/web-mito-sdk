function e(e){return new Promise(function(t,n){var r=new XMLHttpRequest;if(r.open(e.method,e.url),"GET"===e.method.toUpperCase()||"DELETE"===e.method.toUpperCase())r.send(null);else if("POST"===e.method.toUpperCase()){var o=JSON.stringify(e.data);r.setRequestHeader("Content-Type","application/json"),r.send(o)}r.onreadystatechange=function(){if(4==r.readyState)if(200==r.status)try{var e="string"==typeof r.responseText?JSON.parse(r.responseText):r.responseText;t(e)}catch(e){n(e)}else n(r)}})}var t=/*#__PURE__*/function(){function t(e){var t=e.type,n=e.config,r=e.sendApi,o=e.sendResource,s=e.sendJsError;this.name=e.name,this.type=t,this.config=n,this.sendApi=r,this.sendJsError=s,this.sendResource=o}return t.prototype.init=function(){var t,n,r,o,s,i;this.sendApi&&window.XMLHttpRequest&&(t=window.XMLHttpRequest.prototype,n=t.send,r=function(e){e&&e.currentTarget&&200!==e.currentTarget.status&&console.log(e.currentTarget,"apiError")},t.send=function(){if(this.addEventListener)this.addEventListener("error",r),this.addEventListener("load",r),this.addEventListener("abort",r);else{var e=this.onreadystatechange;this.onreadystatechange=function(t){4===this.readyState&&r(t),e&&e.apply(this,arguments)}}return n.apply(this,arguments)}),this.sendApi&&function(e){if(window.fetch){var t=window.fetch;window.fetch=function(){return t.apply(this,arguments).then(function(e){return e}).catch(function(e){throw e})}}}(),this.sendJsError&&(o=this.name,s=this.type,i=this.config,window.addEventListener("error",function(t){t.target.localName||(e({method:"POST",url:"http://localhost:8081/logapi/addErrorLog",data:{title:t.error.message,type:"jsError",detail:encodeURI(t.error.stack),component:o,description:t.filename}}),console.log(t))},!0),window.addEventListener("unhandledrejection",function(t){console.log("这是Promise场景中错误",t),e({method:"POST",url:"http://localhost:8081/logapi/addErrorLog",data:{title:t,type:"jsPromiseError"}})}),"VUE"==s&&(i.errorHandler=function(t,n,r){e({method:"POST",url:"http://localhost:8081/logapi/addErrorLog",data:{title:t.message,type:"vueError",detail:encodeURI(t.stack),component:o,description:"组件"+n.$vnode.tag+"发生错误："+t.message+", "+r}}),console.log(t)})),this.sendResource&&window.addEventListener("error",function(e){e.target.localName&&console.log("这是资源错误",e)},!0)},t}();export{t as webMitoSdkInit};
//# sourceMappingURL=web-mito-sdk.module.js.map
